import{u as m,v as I}from"./chunk-ECKTYOKU.js";import{a as h}from"./chunk-OTYSD24R.js";import{f as S,g as w}from"./chunk-VX6DIAJP.js";import{a as N}from"./chunk-QRWHQ7IS.js";import{a as T,c as u,f as d}from"./chunk-2B6HUC56.js";var f=u(i=>{"use strict";var P=i&&i.__createBinding||(Object.create?(function(e,r,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(r,t);(!o||("get"in o?!r.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,o)}):(function(e,r,t,n){n===void 0&&(n=t),e[n]=r[t]})),W=i&&i.__setModuleDefault||(Object.create?(function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}):function(e,r){e.default=r}),A=i&&i.__importStar||(function(){var e=function(r){return e=Object.getOwnPropertyNames||function(t){var n=[];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[n.length]=o);return n},e(r)};return function(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var n=e(r),o=0;o<n.length;o++)n[o]!=="default"&&P(t,r,n[o]);return W(t,r),t}})();Object.defineProperty(i,"__esModule",{value:!0});i.fromWebToken=void 0;var j=e=>async r=>{e.logger?.debug("@aws-sdk/credential-provider-web-identity - fromWebToken");let{roleArn:t,roleSessionName:n,webIdentityToken:o,providerId:s,policyArns:p,policy:O,durationSeconds:v}=e,{roleAssumerWithWebIdentity:a}=e;if(!a){let{getDefaultRoleAssumerWithWebIdentity:E}=await Promise.resolve().then(()=>A((I(),d(m))));a=E({...e.clientConfig,credentialProviderLogger:e.logger,parentClientConfig:{...r?.callerClientConfig,...e.parentClientConfig}},e.clientPlugins)}return a({RoleArn:t,RoleSessionName:n??`aws-sdk-js-session-${Date.now()}`,WebIdentityToken:o,ProviderId:s,PolicyArns:p,Policy:O,DurationSeconds:v})};i.fromWebToken=j});var b=u(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.fromTokenFile=void 0;var R=(w(),d(S)),F=N(),C=h(),D=T("fs"),q=f(),_="AWS_WEB_IDENTITY_TOKEN_FILE",L="AWS_ROLE_ARN",M="AWS_ROLE_SESSION_NAME",k=(e={})=>async r=>{e.logger?.debug("@aws-sdk/credential-provider-web-identity - fromTokenFile");let t=e?.webIdentityTokenFile??process.env[_],n=e?.roleArn??process.env[L],o=e?.roleSessionName??process.env[M];if(!t||!n)throw new F.CredentialsProviderError("Web identity configuration not specified",{logger:e.logger});let s=await(0,q.fromWebToken)({...e,webIdentityToken:C.externalDataInterceptor?.getTokenRecord?.()[t]??(0,D.readFileSync)(t,{encoding:"ascii"}),roleArn:n,roleSessionName:o})(r);return t===process.env[_]&&(0,R.setCredentialFeature)(s,"CREDENTIALS_ENV_VARS_STS_WEB_ID_TOKEN","h"),s};l.fromTokenFile=k});var V=u(c=>{var y=b(),g=f();Object.keys(y).forEach(function(e){e!=="default"&&!Object.prototype.hasOwnProperty.call(c,e)&&Object.defineProperty(c,e,{enumerable:!0,get:function(){return y[e]}})});Object.keys(g).forEach(function(e){e!=="default"&&!Object.prototype.hasOwnProperty.call(c,e)&&Object.defineProperty(c,e,{enumerable:!0,get:function(){return g[e]}})})});export{V as a};
//# sourceMappingURL=chunk-BGVGABVS.js.map
