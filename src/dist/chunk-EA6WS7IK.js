import{A as rs,B as is,C as as,D as je,E as cs,F as ds,G as ls,H as us,I as ps,a as Gt,b as Ut,c as Mt,e as Vt,i as Ae,j as qe,k as Qt,l as es,p as ts,q as ss,w as W,x as J,y as os,z as Fe}from"./chunk-EA344DRM.js";import{a as Zt,b as ns}from"./chunk-COHAZZTS.js";import{a as He}from"./chunk-OTYSD24R.js";import{L as K,a as zt,b as Bt,c as Wt,f as Jt,t as Yt,u as Xt}from"./chunk-M7G2GFUC.js";import{c as Kt}from"./chunk-MKRX7O3O.js";import{f as Ne,g as De}from"./chunk-VX6DIAJP.js";import{a as Le}from"./chunk-QRWHQ7IS.js";import{a as $t,c as y,f as _}from"./chunk-2B6HUC56.js";var Ue=y(j=>{"use strict";var gs=(De(),_(Ne)),ms=(ss(),_(ts)),g=Le(),H=He(),hs=$t("fs"),fs=({logger:e,signingName:t}={})=>async()=>{if(e?.debug?.("@aws-sdk/token-providers - fromEnvSigningName"),!t)throw new g.TokenProviderError("Please pass 'signingName' to compute environment variable key",{logger:e});let s=ms.getBearerTokenEnvKey(t);if(!(s in process.env))throw new g.TokenProviderError(`Token not present in '${s}' environment variable`,{logger:e});let o={token:process.env[s]};return gs.setTokenFeature(o,"BEARER_SERVICE_ENV_VARS","3"),o},Ss=300*1e3,ye="To refresh this SSO session run 'aws sso login' with the corresponding profile.",ys=async(e,t={})=>{let{SSOOIDCClient:s}=await import("./sso-oidc-WZGQXTTI.js"),o=i=>t.clientConfig?.[i]??t.parentClientConfig?.[i];return new s(Object.assign({},t.clientConfig??{},{region:e??t.clientConfig?.region,logger:o("logger"),userAgentAppId:o("userAgentAppId")}))},_s=async(e,t,s={})=>{let{CreateTokenCommand:o}=await import("./sso-oidc-WZGQXTTI.js");return(await ys(t,s)).send(new o({clientId:e.clientId,clientSecret:e.clientSecret,refreshToken:e.refreshToken,grantType:"refresh_token"}))},$e=e=>{if(e.expiration&&e.expiration.getTime()<Date.now())throw new g.TokenProviderError(`Token is expired. ${ye}`,!1)},I=(e,t,s=!1)=>{if(typeof t>"u")throw new g.TokenProviderError(`Value not present for '${e}' in SSO Token${s?". Cannot refresh":""}. ${ye}`,!1)},{writeFile:vs}=hs.promises,ws=(e,t)=>{let s=H.getSSOTokenFilepath(e),o=JSON.stringify(t,null,2);return vs(s,o)},ze=new Date(0),Ge=(e={})=>async({callerClientConfig:t}={})=>{let s={...e,parentClientConfig:{...t,...e.parentClientConfig}};s.logger?.debug("@aws-sdk/token-providers - fromSso");let o=await H.parseKnownFiles(s),n=H.getProfileName({profile:s.profile??t?.profile}),i=o[n];if(i){if(!i.sso_session)throw new g.TokenProviderError(`Profile '${n}' is missing required property 'sso_session'.`)}else throw new g.TokenProviderError(`Profile '${n}' could not be found in shared credentials file.`,!1);let d=i.sso_session,u=(await H.loadSsoSessionData(s))[d];if(!u)throw new g.TokenProviderError(`Sso session '${d}' could not be found in shared credentials file.`,!1);for(let l of["sso_start_url","sso_region"])if(!u[l])throw new g.TokenProviderError(`Sso session '${d}' is missing required property '${l}'.`,!1);u.sso_start_url;let T=u.sso_region,a;try{a=await H.getSSOTokenFromFile(d)}catch{throw new g.TokenProviderError(`The SSO session token associated with profile=${n} was not found or is invalid. ${ye}`,!1)}I("accessToken",a.accessToken),I("expiresAt",a.expiresAt);let{accessToken:x,expiresAt:v}=a,p={token:x,expiration:new Date(v)};if(p.expiration.getTime()-Date.now()>Ss)return p;if(Date.now()-ze.getTime()<30*1e3)return $e(p),p;I("clientId",a.clientId,!0),I("clientSecret",a.clientSecret,!0),I("refreshToken",a.refreshToken,!0);try{ze.setTime(Date.now());let l=await _s(a,T,s);I("accessToken",l.accessToken),I("expiresIn",l.expiresIn);let A=new Date(Date.now()+l.expiresIn*1e3);try{await ws(d,{...a,accessToken:l.accessToken,expiresAt:A.toISOString(),refreshToken:l.refreshToken})}catch{}return{token:l.accessToken,expiration:A}}catch{return $e(p),p}},Cs=({token:e,logger:t})=>async()=>{if(t?.debug("@aws-sdk/token-providers - fromStatic"),!e||!e.token)throw new g.TokenProviderError("Please pass a valid token to fromStatic",!1);return e},Es=(e={})=>g.memoize(g.chain(Ge(e),async()=>{throw new g.TokenProviderError("Could not load token from any providers",!1)}),t=>t.expiration!==void 0&&t.expiration.getTime()-Date.now()<3e5,t=>t.expiration!==void 0);j.fromEnvSigningName=fs;j.fromSso=Ge;j.fromStatic=Cs;j.nodeProvider=Es});var ve=y(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.resolveHttpAuthSchemeConfig=P.defaultSSOHttpAuthSchemeProvider=P.defaultSSOHttpAuthSchemeParametersProvider=void 0;var Ps=(J(),_(W)),_e=Bt(),ks=async(e,t,s)=>({operation:(0,_e.getSmithyContext)(t).operation,region:await(0,_e.normalizeProvider)(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});P.defaultSSOHttpAuthSchemeParametersProvider=ks;function bs(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"awsssoportal",region:e.region},propertiesExtractor:(t,s)=>({signingProperties:{config:t,context:s}})}}function Y(e){return{schemeId:"smithy.api#noAuth"}}var xs=e=>{let t=[];switch(e.operation){case"GetRoleCredentials":{t.push(Y(e));break}case"ListAccountRoles":{t.push(Y(e));break}case"ListAccounts":{t.push(Y(e));break}case"Logout":{t.push(Y(e));break}default:t.push(bs(e))}return t};P.defaultSSOHttpAuthSchemeProvider=xs;var Rs=e=>{let t=(0,Ps.resolveAwsSdkSigV4Config)(e);return Object.assign(t,{authSchemePreference:(0,_e.normalizeProvider)(e.authSchemePreference??[])})};P.resolveHttpAuthSchemeConfig=Rs});var Me=y((To,Is)=>{Is.exports={name:"@aws-sdk/client-sso",description:"AWS SDK for JavaScript Sso Client for Node.js, Browser and React Native",version:"3.922.0",scripts:{build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline client-sso","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo sso"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/core":"3.922.0","@aws-sdk/middleware-host-header":"3.922.0","@aws-sdk/middleware-logger":"3.922.0","@aws-sdk/middleware-recursion-detection":"3.922.0","@aws-sdk/middleware-user-agent":"3.922.0","@aws-sdk/region-config-resolver":"3.922.0","@aws-sdk/types":"3.922.0","@aws-sdk/util-endpoints":"3.922.0","@aws-sdk/util-user-agent-browser":"3.922.0","@aws-sdk/util-user-agent-node":"3.922.0","@smithy/config-resolver":"^4.4.1","@smithy/core":"^3.17.2","@smithy/fetch-http-handler":"^5.3.5","@smithy/hash-node":"^4.2.4","@smithy/invalid-dependency":"^4.2.4","@smithy/middleware-content-length":"^4.2.4","@smithy/middleware-endpoint":"^4.3.6","@smithy/middleware-retry":"^4.4.6","@smithy/middleware-serde":"^4.2.4","@smithy/middleware-stack":"^4.2.4","@smithy/node-config-provider":"^4.3.4","@smithy/node-http-handler":"^4.4.4","@smithy/protocol-http":"^5.3.4","@smithy/smithy-client":"^4.9.2","@smithy/types":"^4.8.1","@smithy/url-parser":"^4.2.4","@smithy/util-base64":"^4.3.0","@smithy/util-body-length-browser":"^4.2.0","@smithy/util-body-length-node":"^4.2.1","@smithy/util-defaults-mode-browser":"^4.3.5","@smithy/util-defaults-mode-node":"^4.2.7","@smithy/util-endpoints":"^3.2.4","@smithy/util-middleware":"^4.2.4","@smithy/util-retry":"^4.2.4","@smithy/util-utf8":"^4.2.0",tslib:"^2.6.2"},devDependencies:{"@tsconfig/node18":"18.2.4","@types/node":"^18.19.69",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~5.8.3"},engines:{node:">=18.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-sso",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-sso"}}});var nt=y(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.ruleSet=void 0;var tt="required",h="fn",f="argv",L="ref",Be=!0,Ve="isSet",$="booleanEquals",N="error",D="endpoint",w="tree",we="PartitionResult",Ce="getAttr",Ke={[tt]:!1,type:"string"},We={[tt]:!0,default:!1,type:"boolean"},Je={[L]:"Endpoint"},st={[h]:$,[f]:[{[L]:"UseFIPS"},!0]},ot={[h]:$,[f]:[{[L]:"UseDualStack"},!0]},m={},Ye={[h]:Ce,[f]:[{[L]:we},"supportsFIPS"]},rt={[L]:we},Xe={[h]:$,[f]:[!0,{[h]:Ce,[f]:[rt,"supportsDualStack"]}]},Qe=[st],Ze=[ot],et=[{[L]:"Region"}],Os={version:"1.0",parameters:{Region:Ke,UseDualStack:We,UseFIPS:We,Endpoint:Ke},rules:[{conditions:[{[h]:Ve,[f]:[Je]}],rules:[{conditions:Qe,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:N},{conditions:Ze,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:N},{endpoint:{url:Je,properties:m,headers:m},type:D}],type:w},{conditions:[{[h]:Ve,[f]:et}],rules:[{conditions:[{[h]:"aws.partition",[f]:et,assign:we}],rules:[{conditions:[st,ot],rules:[{conditions:[{[h]:$,[f]:[Be,Ye]},Xe],rules:[{endpoint:{url:"https://portal.sso-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:m,headers:m},type:D}],type:w},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:N}],type:w},{conditions:Qe,rules:[{conditions:[{[h]:$,[f]:[Ye,Be]}],rules:[{conditions:[{[h]:"stringEquals",[f]:[{[h]:Ce,[f]:[rt,"name"]},"aws-us-gov"]}],endpoint:{url:"https://portal.sso.{Region}.amazonaws.com",properties:m,headers:m},type:D},{endpoint:{url:"https://portal.sso-fips.{Region}.{PartitionResult#dnsSuffix}",properties:m,headers:m},type:D}],type:w},{error:"FIPS is enabled but this partition does not support FIPS",type:N}],type:w},{conditions:Ze,rules:[{conditions:[Xe],rules:[{endpoint:{url:"https://portal.sso.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:m,headers:m},type:D}],type:w},{error:"DualStack is enabled but this partition does not support DualStack",type:N}],type:w},{endpoint:{url:"https://portal.sso.{Region}.{PartitionResult#dnsSuffix}",properties:m,headers:m},type:D}],type:w}],type:w},{error:"Invalid Configuration: Missing Region",type:N}]};X.ruleSet=Os});var it=y(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.defaultEndpointResolver=void 0;var Ts=es(),Ee=Qt(),As=nt(),qs=new Ee.EndpointCache({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),Ns=(e,t={})=>qs.get(e,()=>(0,Ee.resolveEndpoint)(As.ruleSet,{endpointParams:e,logger:t.logger}));Q.defaultEndpointResolver=Ns;Ee.customEndpointFunctions.aws=Ts.awsEndpointFunctions});var dt=y(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.getRuntimeConfig=void 0;var Ds=(J(),_(W)),Ls=(qe(),_(Ae)),Fs=K(),Hs=Zt(),at=Wt(),ct=Kt(),js=ve(),$s=it(),zs=e=>({apiVersion:"2019-06-10",base64Decoder:e?.base64Decoder??at.fromBase64,base64Encoder:e?.base64Encoder??at.toBase64,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??$s.defaultEndpointResolver,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??js.defaultSSOHttpAuthSchemeProvider,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4"),signer:new Ds.AwsSdkSigV4Signer},{schemeId:"smithy.api#noAuth",identityProvider:t=>t.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new Ls.NoAuthSigner}],logger:e?.logger??new Fs.NoOpLogger,serviceId:e?.serviceId??"SSO",urlParser:e?.urlParser??Hs.parseUrl,utf8Decoder:e?.utf8Decoder??ct.fromUtf8,utf8Encoder:e?.utf8Encoder??ct.toUtf8});Z.getRuntimeConfig=zs});var mt=y(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.getRuntimeConfig=void 0;var Gs=(Xt(),_(Yt)),Us=Gs.__importDefault(Me()),lt=(J(),_(W)),ut=cs(),ee=Fe(),Ms=ds(),pt=je(),O=ns(),gt=Jt(),Bs=ls(),Vs=as(),Ks=dt(),Ws=K(),Js=us(),Ys=K(),Xs=e=>{(0,Ys.emitWarningIfUnsupportedVersion)(process.version);let t=(0,Js.resolveDefaultsModeConfig)(e),s=()=>t().then(Ws.loadConfigsForDefaultMode),o=(0,Ks.getRuntimeConfig)(e);(0,lt.emitWarningIfUnsupportedVersion)(process.version);let n={profile:e?.profile,logger:o.logger};return{...o,...e,runtime:"node",defaultsMode:t,authSchemePreference:e?.authSchemePreference??(0,O.loadConfig)(lt.NODE_AUTH_SCHEME_PREFERENCE_OPTIONS,n),bodyLengthChecker:e?.bodyLengthChecker??Bs.calculateBodyLength,defaultUserAgentProvider:e?.defaultUserAgentProvider??(0,ut.createDefaultUserAgentProvider)({serviceId:o.serviceId,clientVersion:Us.default.version}),maxAttempts:e?.maxAttempts??(0,O.loadConfig)(pt.NODE_MAX_ATTEMPT_CONFIG_OPTIONS,e),region:e?.region??(0,O.loadConfig)(ee.NODE_REGION_CONFIG_OPTIONS,{...ee.NODE_REGION_CONFIG_FILE_OPTIONS,...n}),requestHandler:gt.NodeHttpHandler.create(e?.requestHandler??s),retryMode:e?.retryMode??(0,O.loadConfig)({...pt.NODE_RETRY_MODE_CONFIG_OPTIONS,default:async()=>(await s()).retryMode||Vs.DEFAULT_RETRY_MODE},e),sha256:e?.sha256??Ms.Hash.bind(null,"sha256"),streamCollector:e?.streamCollector??gt.streamCollector,useDualstackEndpoint:e?.useDualstackEndpoint??(0,O.loadConfig)(ee.NODE_USE_DUALSTACK_ENDPOINT_CONFIG_OPTIONS,n),useFipsEndpoint:e?.useFipsEndpoint??(0,O.loadConfig)(ee.NODE_USE_FIPS_ENDPOINT_CONFIG_OPTIONS,n),userAgentAppId:e?.userAgentAppId??(0,O.loadConfig)(ut.NODE_APP_ID_CONFIG_OPTIONS,n)}};te.getRuntimeConfig=Xs});var qt=y(c=>{"use strict";var ht=Gt(),Qs=Ut(),Zs=Mt(),ft=os(),eo=Fe(),C=(qe(),_(Ae)),to=rs(),M=is(),St=je(),r=K(),yt=ve(),so=mt(),_t=ps(),vt=zt(),de=Vt(),z=(J(),_(W)),oo=e=>Object.assign(e,{useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"awsssoportal"}),le={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},ro=e=>{let t=e.httpAuthSchemes,s=e.httpAuthSchemeProvider,o=e.credentials;return{setHttpAuthScheme(n){let i=t.findIndex(d=>d.schemeId===n.schemeId);i===-1?t.push(n):t.splice(i,1,n)},httpAuthSchemes(){return t},setHttpAuthSchemeProvider(n){s=n},httpAuthSchemeProvider(){return s},setCredentials(n){o=n},credentials(){return o}}},no=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials()}),io=(e,t)=>{let s=Object.assign(_t.getAwsRegionExtensionConfiguration(e),r.getDefaultExtensionConfiguration(e),vt.getHttpHandlerExtensionConfiguration(e),ro(e));return t.forEach(o=>o.configure(s)),Object.assign(e,_t.resolveAwsRegionExtensionConfiguration(s),r.resolveDefaultRuntimeConfig(s),vt.resolveHttpHandlerRuntimeConfig(s),no(s))},F=class extends r.Client{config;constructor(...[t]){let s=so.getRuntimeConfig(t||{});super(s),this.initConfig=s;let o=oo(s),n=ft.resolveUserAgentConfig(o),i=St.resolveRetryConfig(n),d=eo.resolveRegionConfig(i),E=ht.resolveHostHeaderConfig(d),u=M.resolveEndpointConfig(E),T=yt.resolveHttpAuthSchemeConfig(u),a=io(T,t?.extensions||[]);this.config=a,this.middlewareStack.use(ft.getUserAgentPlugin(this.config)),this.middlewareStack.use(St.getRetryPlugin(this.config)),this.middlewareStack.use(to.getContentLengthPlugin(this.config)),this.middlewareStack.use(ht.getHostHeaderPlugin(this.config)),this.middlewareStack.use(Qs.getLoggerPlugin(this.config)),this.middlewareStack.use(Zs.getRecursionDetectionPlugin(this.config)),this.middlewareStack.use(C.getHttpAuthSchemeEndpointRuleSetPlugin(this.config,{httpAuthSchemeParametersProvider:yt.defaultSSOHttpAuthSchemeParametersProvider,identityProviderConfigProvider:async x=>new C.DefaultIdentityProviderConfig({"aws.auth#sigv4":x.credentials})})),this.middlewareStack.use(C.getHttpSigningPlugin(this.config))}destroy(){super.destroy()}},k=class e extends r.ServiceException{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},se=class e extends k{name="InvalidRequestException";$fault="client";constructor(t){super({name:"InvalidRequestException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},oe=class e extends k{name="ResourceNotFoundException";$fault="client";constructor(t){super({name:"ResourceNotFoundException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},re=class e extends k{name="TooManyRequestsException";$fault="client";constructor(t){super({name:"TooManyRequestsException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},ne=class e extends k{name="UnauthorizedException";$fault="client";constructor(t){super({name:"UnauthorizedException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},wt=e=>({...e,...e.accessToken&&{accessToken:r.SENSITIVE_STRING}}),Ct=e=>({...e,...e.secretAccessKey&&{secretAccessKey:r.SENSITIVE_STRING},...e.sessionToken&&{sessionToken:r.SENSITIVE_STRING}}),Et=e=>({...e,...e.roleCredentials&&{roleCredentials:Ct(e.roleCredentials)}}),Pt=e=>({...e,...e.accessToken&&{accessToken:r.SENSITIVE_STRING}}),kt=e=>({...e,...e.accessToken&&{accessToken:r.SENSITIVE_STRING}}),bt=e=>({...e,...e.accessToken&&{accessToken:r.SENSITIVE_STRING}}),ao=async(e,t)=>{let s=C.requestBuilder(e,t),o=r.map({},r.isSerializableHeaderValue,{[ge]:e[pe]});s.bp("/federation/credentials");let n=r.map({[Co]:[,r.expectNonNull(e[wo],"roleName")],[Rt]:[,r.expectNonNull(e[xt],"accountId")]});return s.m("GET").h(o).q(n).b(void 0),s.build()},co=async(e,t)=>{let s=C.requestBuilder(e,t),o=r.map({},r.isSerializableHeaderValue,{[ge]:e[pe]});s.bp("/assignment/roles");let n=r.map({[At]:[,e[Tt]],[Ot]:[()=>e.maxResults!==void 0,()=>e[It].toString()],[Rt]:[,r.expectNonNull(e[xt],"accountId")]});return s.m("GET").h(o).q(n).b(void 0),s.build()},lo=async(e,t)=>{let s=C.requestBuilder(e,t),o=r.map({},r.isSerializableHeaderValue,{[ge]:e[pe]});s.bp("/assignment/accounts");let n=r.map({[At]:[,e[Tt]],[Ot]:[()=>e.maxResults!==void 0,()=>e[It].toString()]});return s.m("GET").h(o).q(n).b(void 0),s.build()},uo=async(e,t)=>{let s=C.requestBuilder(e,t),o=r.map({},r.isSerializableHeaderValue,{[ge]:e[pe]});return s.bp("/logout"),s.m("POST").h(o).b(void 0),s.build()},po=async(e,t)=>{if(e.statusCode!==200&&e.statusCode>=300)return ue(e,t);let s=r.map({$metadata:b(e)}),o=r.expectNonNull(r.expectObject(await z.parseJsonBody(e.body,t)),"body"),n=r.take(o,{roleCredentials:r._json});return Object.assign(s,n),s},go=async(e,t)=>{if(e.statusCode!==200&&e.statusCode>=300)return ue(e,t);let s=r.map({$metadata:b(e)}),o=r.expectNonNull(r.expectObject(await z.parseJsonBody(e.body,t)),"body"),n=r.take(o,{nextToken:r.expectString,roleList:r._json});return Object.assign(s,n),s},mo=async(e,t)=>{if(e.statusCode!==200&&e.statusCode>=300)return ue(e,t);let s=r.map({$metadata:b(e)}),o=r.expectNonNull(r.expectObject(await z.parseJsonBody(e.body,t)),"body"),n=r.take(o,{accountList:r._json,nextToken:r.expectString});return Object.assign(s,n),s},ho=async(e,t)=>{if(e.statusCode!==200&&e.statusCode>=300)return ue(e,t);let s=r.map({$metadata:b(e)});return await r.collectBody(e.body,t),s},ue=async(e,t)=>{let s={...e,body:await z.parseJsonErrorBody(e.body,t)},o=z.loadRestJsonErrorCode(e,s.body);switch(o){case"InvalidRequestException":case"com.amazonaws.sso#InvalidRequestException":throw await So(s);case"ResourceNotFoundException":case"com.amazonaws.sso#ResourceNotFoundException":throw await yo(s);case"TooManyRequestsException":case"com.amazonaws.sso#TooManyRequestsException":throw await _o(s);case"UnauthorizedException":case"com.amazonaws.sso#UnauthorizedException":throw await vo(s);default:let n=s.body;return fo({output:e,parsedBody:n,errorCode:o})}},fo=r.withBaseException(k),So=async(e,t)=>{let s=r.map({}),o=e.body,n=r.take(o,{message:r.expectString});Object.assign(s,n);let i=new se({$metadata:b(e),...s});return r.decorateServiceException(i,e.body)},yo=async(e,t)=>{let s=r.map({}),o=e.body,n=r.take(o,{message:r.expectString});Object.assign(s,n);let i=new oe({$metadata:b(e),...s});return r.decorateServiceException(i,e.body)},_o=async(e,t)=>{let s=r.map({}),o=e.body,n=r.take(o,{message:r.expectString});Object.assign(s,n);let i=new re({$metadata:b(e),...s});return r.decorateServiceException(i,e.body)},vo=async(e,t)=>{let s=r.map({}),o=e.body,n=r.take(o,{message:r.expectString});Object.assign(s,n);let i=new ne({$metadata:b(e),...s});return r.decorateServiceException(i,e.body)},b=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),xt="accountId",pe="accessToken",Rt="account_id",It="maxResults",Ot="max_result",Tt="nextToken",At="next_token",wo="roleName",Co="role_name",ge="x-amz-sso_bearer_token",ie=class extends r.Command.classBuilder().ep(le).m(function(t,s,o,n){return[de.getSerdePlugin(o,this.serialize,this.deserialize),M.getEndpointPlugin(o,t.getEndpointParameterInstructions())]}).s("SWBPortalService","GetRoleCredentials",{}).n("SSOClient","GetRoleCredentialsCommand").f(wt,Et).ser(ao).de(po).build(){},G=class extends r.Command.classBuilder().ep(le).m(function(t,s,o,n){return[de.getSerdePlugin(o,this.serialize,this.deserialize),M.getEndpointPlugin(o,t.getEndpointParameterInstructions())]}).s("SWBPortalService","ListAccountRoles",{}).n("SSOClient","ListAccountRolesCommand").f(Pt,void 0).ser(co).de(go).build(){},U=class extends r.Command.classBuilder().ep(le).m(function(t,s,o,n){return[de.getSerdePlugin(o,this.serialize,this.deserialize),M.getEndpointPlugin(o,t.getEndpointParameterInstructions())]}).s("SWBPortalService","ListAccounts",{}).n("SSOClient","ListAccountsCommand").f(kt,void 0).ser(lo).de(mo).build(){},ae=class extends r.Command.classBuilder().ep(le).m(function(t,s,o,n){return[de.getSerdePlugin(o,this.serialize,this.deserialize),M.getEndpointPlugin(o,t.getEndpointParameterInstructions())]}).s("SWBPortalService","Logout",{}).n("SSOClient","LogoutCommand").f(bt,void 0).ser(uo).de(ho).build(){},Eo={GetRoleCredentialsCommand:ie,ListAccountRolesCommand:G,ListAccountsCommand:U,LogoutCommand:ae},ce=class extends F{};r.createAggregatedClient(Eo,ce);var Po=C.createPaginator(F,G,"nextToken","nextToken","maxResults"),ko=C.createPaginator(F,U,"nextToken","nextToken","maxResults");Object.defineProperty(c,"$Command",{enumerable:!0,get:function(){return r.Command}});Object.defineProperty(c,"__Client",{enumerable:!0,get:function(){return r.Client}});c.GetRoleCredentialsCommand=ie;c.GetRoleCredentialsRequestFilterSensitiveLog=wt;c.GetRoleCredentialsResponseFilterSensitiveLog=Et;c.InvalidRequestException=se;c.ListAccountRolesCommand=G;c.ListAccountRolesRequestFilterSensitiveLog=Pt;c.ListAccountsCommand=U;c.ListAccountsRequestFilterSensitiveLog=kt;c.LogoutCommand=ae;c.LogoutRequestFilterSensitiveLog=bt;c.ResourceNotFoundException=oe;c.RoleCredentialsFilterSensitiveLog=Ct;c.SSO=ce;c.SSOClient=F;c.SSOServiceException=k;c.TooManyRequestsException=re;c.UnauthorizedException=ne;c.paginateListAccountRoles=Po;c.paginateListAccounts=ko});var Dt=y(Pe=>{"use strict";var Nt=qt();Object.defineProperty(Pe,"GetRoleCredentialsCommand",{enumerable:!0,get:function(){return Nt.GetRoleCredentialsCommand}});Object.defineProperty(Pe,"SSOClient",{enumerable:!0,get:function(){return Nt.SSOClient}})});var Ro=y(he=>{var S=Le(),me=He(),Lt=(De(),_(Ne)),bo=Ue(),Ht=e=>e&&(typeof e.sso_start_url=="string"||typeof e.sso_account_id=="string"||typeof e.sso_session=="string"||typeof e.sso_region=="string"||typeof e.sso_role_name=="string"),B=!1,Ft=async({ssoStartUrl:e,ssoSession:t,ssoAccountId:s,ssoRegion:o,ssoRoleName:n,ssoClient:i,clientConfig:d,parentClientConfig:E,profile:u,filepath:T,configFilepath:a,ignoreCache:x,logger:v})=>{let p,l="To refresh this SSO session run aws sso login with the corresponding profile.";if(t)try{let R=await bo.fromSso({profile:u,filepath:T,configFilepath:a,ignoreCache:x})();p={accessToken:R.token,expiresAt:new Date(R.expiration).toISOString()}}catch(R){throw new S.CredentialsProviderError(R.message,{tryNextLink:B,logger:v})}else try{p=await me.getSSOTokenFromFile(e)}catch{throw new S.CredentialsProviderError(`The SSO session associated with this profile is invalid. ${l}`,{tryNextLink:B,logger:v})}if(new Date(p.expiresAt).getTime()-Date.now()<=0)throw new S.CredentialsProviderError(`The SSO session associated with this profile has expired. ${l}`,{tryNextLink:B,logger:v});let{accessToken:A}=p,{SSOClient:fe,GetRoleCredentialsCommand:q}=await Promise.resolve().then(function(){return Dt()}),V=i||new fe(Object.assign({},d??{},{logger:d?.logger??E?.logger,region:d?.region??o,userAgentAppId:d?.userAgentAppId??E?.userAgentAppId})),ke;try{ke=await V.send(new q({accountId:s,roleName:n,accessToken:A}))}catch(R){throw new S.CredentialsProviderError(R,{tryNextLink:B,logger:v})}let{roleCredentials:{accessKeyId:be,secretAccessKey:xe,sessionToken:Re,expiration:Ie,credentialScope:Oe,accountId:Te}={}}=ke;if(!be||!xe||!Re||!Ie)throw new S.CredentialsProviderError("SSO returns an invalid temporary credential.",{tryNextLink:B,logger:v});let Se={accessKeyId:be,secretAccessKey:xe,sessionToken:Re,expiration:new Date(Ie),...Oe&&{credentialScope:Oe},...Te&&{accountId:Te}};return t?Lt.setCredentialFeature(Se,"CREDENTIALS_SSO","s"):Lt.setCredentialFeature(Se,"CREDENTIALS_SSO_LEGACY","u"),Se},jt=(e,t)=>{let{sso_start_url:s,sso_account_id:o,sso_region:n,sso_role_name:i}=e;if(!s||!o||!n||!i)throw new S.CredentialsProviderError(`Profile is configured with invalid SSO credentials. Required parameters "sso_account_id", "sso_region", "sso_role_name", "sso_start_url". Got ${Object.keys(e).join(", ")}
Reference: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html`,{tryNextLink:!1,logger:t});return e},xo=(e={})=>async({callerClientConfig:t}={})=>{e.logger?.debug("@aws-sdk/credential-provider-sso - fromSSO");let{ssoStartUrl:s,ssoAccountId:o,ssoRegion:n,ssoRoleName:i,ssoSession:d}=e,{ssoClient:E}=e,u=me.getProfileName({profile:e.profile??t?.profile});if(!s&&!o&&!n&&!i&&!d){let a=(await me.parseKnownFiles(e))[u];if(!a)throw new S.CredentialsProviderError(`Profile ${u} was not found.`,{logger:e.logger});if(!Ht(a))throw new S.CredentialsProviderError(`Profile ${u} is not configured with SSO credentials.`,{logger:e.logger});if(a?.sso_session){let q=(await me.loadSsoSessionData(e))[a.sso_session],V=` configurations in profile ${u} and sso-session ${a.sso_session}`;if(n&&n!==q.sso_region)throw new S.CredentialsProviderError("Conflicting SSO region"+V,{tryNextLink:!1,logger:e.logger});if(s&&s!==q.sso_start_url)throw new S.CredentialsProviderError("Conflicting SSO start_url"+V,{tryNextLink:!1,logger:e.logger});a.sso_region=q.sso_region,a.sso_start_url=q.sso_start_url}let{sso_start_url:x,sso_account_id:v,sso_region:p,sso_role_name:l,sso_session:A}=jt(a,e.logger);return Ft({ssoStartUrl:x,ssoSession:A,ssoAccountId:v,ssoRegion:p,ssoRoleName:l,ssoClient:E,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,profile:u,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger})}else{if(!s||!o||!n||!i)throw new S.CredentialsProviderError('Incomplete configuration. The fromSSO() argument hash must include "ssoStartUrl", "ssoAccountId", "ssoRegion", "ssoRoleName"',{tryNextLink:!1,logger:e.logger});return Ft({ssoStartUrl:s,ssoSession:d,ssoAccountId:o,ssoRegion:n,ssoRoleName:i,ssoClient:E,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,profile:u,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger})}};he.fromSSO=xo;he.isSsoProfile=Ht;he.validateSsoProfile=jt});export{Ue as a,Ro as b};
//# sourceMappingURL=chunk-EA6WS7IK.js.map
