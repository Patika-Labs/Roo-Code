import{a as O}from"./chunk-OTYSD24R.js";import{f as p,g as R}from"./chunk-VX6DIAJP.js";import{a as A}from"./chunk-QRWHQ7IS.js";import{c as I,f as S}from"./chunk-2B6HUC56.js";var M=I(w=>{var f=O(),l=A(),a=(R(),S(p)),b=(e,t,r)=>{let s={EcsContainer:async i=>{let{fromHttp:n}=await import("./dist-cjs-ZDLXCKAS.js"),{fromContainerMetadata:o}=await import("./dist-cjs-DVNK5WPR.js");return r?.debug("@aws-sdk/credential-provider-ini - credential_source is EcsContainer"),async()=>l.chain(n(i??{}),o(i))().then(u)},Ec2InstanceMetadata:async i=>{r?.debug("@aws-sdk/credential-provider-ini - credential_source is Ec2InstanceMetadata");let{fromInstanceMetadata:n}=await import("./dist-cjs-DVNK5WPR.js");return async()=>n(i)().then(u)},Environment:async i=>{r?.debug("@aws-sdk/credential-provider-ini - credential_source is Environment");let{fromEnv:n}=await import("./dist-cjs-IJA6GEL7.js");return async()=>n(i)().then(u)}};if(e in s)return s[e];throw new l.CredentialsProviderError(`Unsupported credential source in profile ${t}. Got ${e}, expected EcsContainer or Ec2InstanceMetadata or Environment.`,{logger:r})},u=e=>a.setCredentialFeature(e,"CREDENTIALS_PROFILE_NAMED_PROVIDER","p"),h=(e,{profile:t="default",logger:r}={})=>!!e&&typeof e=="object"&&typeof e.role_arn=="string"&&["undefined","string"].indexOf(typeof e.role_session_name)>-1&&["undefined","string"].indexOf(typeof e.external_id)>-1&&["undefined","string"].indexOf(typeof e.mfa_serial)>-1&&(k(e,{profile:t,logger:r})||F(e,{profile:t,logger:r})),k=(e,{profile:t,logger:r})=>{let s=typeof e.source_profile=="string"&&typeof e.credential_source>"u";return s&&r?.debug?.(`    ${t} isAssumeRoleWithSourceProfile source_profile=${e.source_profile}`),s},F=(e,{profile:t,logger:r})=>{let s=typeof e.credential_source=="string"&&typeof e.source_profile>"u";return s&&r?.debug?.(`    ${t} isCredentialSourceProfile credential_source=${e.credential_source}`),s},L=async(e,t,r,s={},i)=>{r.logger?.debug("@aws-sdk/credential-provider-ini - resolveAssumeRoleCredentials (STS)");let n=t[e],{source_profile:o,region:m}=n;if(!r.roleAssumer){let{getDefaultRoleAssumer:c}=await import("./sts-EZEMCYIP.js");r.roleAssumer=c({...r.clientConfig,credentialProviderLogger:r.logger,parentClientConfig:{...r?.parentClientConfig,region:m??r?.parentClientConfig?.region}},r.clientPlugins)}if(o&&o in s)throw new l.CredentialsProviderError(`Detected a cycle attempting to resolve credentials for profile ${f.getProfileName(r)}. Profiles visited: `+Object.keys(s).join(", "),{logger:r.logger});r.logger?.debug(`@aws-sdk/credential-provider-ini - finding credential resolver using ${o?`source_profile=[${o}]`:`profile=[${e}]`}`);let _=o?i(o,t,r,{...s,[o]:!0},C(t[o]??{})):(await b(n.credential_source,e,r.logger)(r))();if(C(n))return _.then(c=>a.setCredentialFeature(c,"CREDENTIALS_PROFILE_SOURCE_PROFILE","o"));{let c={RoleArn:n.role_arn,RoleSessionName:n.role_session_name||`aws-sdk-js-${Date.now()}`,ExternalId:n.external_id,DurationSeconds:parseInt(n.duration_seconds||"3600",10)},{mfa_serial:d}=n;if(d){if(!r.mfaCodeProvider)throw new l.CredentialsProviderError(`Profile ${e} requires multi-factor authentication, but no MFA code callback was provided.`,{logger:r.logger,tryNextLink:!1});c.SerialNumber=d,c.TokenCode=await r.mfaCodeProvider(d)}let P=await _;return r.roleAssumer(P,c).then(v=>a.setCredentialFeature(v,"CREDENTIALS_PROFILE_SOURCE_PROFILE","o"))}},C=e=>!e.role_arn&&!!e.credential_source,D=e=>!!e&&typeof e=="object"&&typeof e.credential_process=="string",T=async(e,t)=>import("./dist-cjs-XTB3MMBI.js").then(({fromProcess:r})=>r({...e,profile:t})().then(s=>a.setCredentialFeature(s,"CREDENTIALS_PROFILE_PROCESS","v"))),$=async(e,t,r={})=>{let{fromSSO:s}=await import("./dist-cjs-PTMPZTOS.js");return s({profile:e,logger:r.logger,parentClientConfig:r.parentClientConfig,clientConfig:r.clientConfig})().then(i=>t.sso_session?a.setCredentialFeature(i,"CREDENTIALS_PROFILE_SSO","r"):a.setCredentialFeature(i,"CREDENTIALS_PROFILE_SSO_LEGACY","t"))},x=e=>e&&(typeof e.sso_start_url=="string"||typeof e.sso_account_id=="string"||typeof e.sso_session=="string"||typeof e.sso_region=="string"||typeof e.sso_role_name=="string"),g=e=>!!e&&typeof e=="object"&&typeof e.aws_access_key_id=="string"&&typeof e.aws_secret_access_key=="string"&&["undefined","string"].indexOf(typeof e.aws_session_token)>-1&&["undefined","string"].indexOf(typeof e.aws_account_id)>-1,y=async(e,t)=>{t?.logger?.debug("@aws-sdk/credential-provider-ini - resolveStaticCredentials");let r={accessKeyId:e.aws_access_key_id,secretAccessKey:e.aws_secret_access_key,sessionToken:e.aws_session_token,...e.aws_credential_scope&&{credentialScope:e.aws_credential_scope},...e.aws_account_id&&{accountId:e.aws_account_id}};return a.setCredentialFeature(r,"CREDENTIALS_PROFILE","n")},W=e=>!!e&&typeof e=="object"&&typeof e.web_identity_token_file=="string"&&typeof e.role_arn=="string"&&["undefined","string"].indexOf(typeof e.role_session_name)>-1,N=async(e,t)=>import("./dist-cjs-PMQTMX2A.js").then(({fromTokenFile:r})=>r({webIdentityTokenFile:e.web_identity_token_file,roleArn:e.role_arn,roleSessionName:e.role_session_name,roleAssumerWithWebIdentity:t.roleAssumerWithWebIdentity,logger:t.logger,parentClientConfig:t.parentClientConfig})().then(s=>a.setCredentialFeature(s,"CREDENTIALS_PROFILE_STS_WEB_ID_TOKEN","q"))),E=async(e,t,r,s={},i=!1)=>{let n=t[e];if(Object.keys(s).length>0&&g(n))return y(n,r);if(i||h(n,{profile:e,logger:r.logger}))return L(e,t,r,s,E);if(g(n))return y(n,r);if(W(n))return N(n,r);if(D(n))return T(r,e);if(x(n))return await $(e,n,r);throw new l.CredentialsProviderError(`Could not resolve credentials using profile: [${e}] in configuration/credentials file(s).`,{logger:r.logger})},j=(e={})=>async({callerClientConfig:t}={})=>{let r={...e,parentClientConfig:{...t,...e.parentClientConfig}};r.logger?.debug("@aws-sdk/credential-provider-ini - fromIni");let s=await f.parseKnownFiles(r);return E(f.getProfileName({profile:e.profile??t?.profile}),s,r)};w.fromIni=j});export{M as a};
//# sourceMappingURL=chunk-RV4GLWNU.js.map
